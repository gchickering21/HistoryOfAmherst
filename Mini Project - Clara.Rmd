---
title: "Mini Project - Clara"
author: "Clara Seo"
date: "9/29/2020"
output: pdf_document
---

```{r setup, include=FALSE}
library(readtext)
library(tidytext)
library(tidyverse)
library(dplyr)
library(tidyr)
library(kableExtra)
knitr::opts_chunk$set(echo = TRUE)
```

```{r data read-in}
# Read in all files from a folder called "chapter_files"
text <- readtext("chapter_files/*.txt")

n_chapters <- nrow(text)
for(i in 1:n_chapters){
  # single string of text that contains the entire chapter
  temp_chapter <- text[i,2]
  
  # rename string with appropriate chapter number
  assign(paste("chapter", i-1, "_raw", sep=""), temp_chapter)
}
```

```{r}
# strsplit returns a list: we only want the first element
chapter8 <- stringr::str_split(chapter8_raw, "\n")[[1]]

# function to remove hyphen and merge hyphenated word
removeHyphen_concat <- function(chapter) {

  # remove whitespaces on the right side (at end of line)
  chapter <- str_trim(chapter, side = "right")

  # determine which lines end with hyphen
  is_end_hyphen <- str_detect(chapter, regex("\\-$"))

  i <- length(is_end_hyphen)
  for (r in 1:i) {
    if (is_end_hyphen[r] == TRUE) {
      # extract second-half of hyphenated word, delete from carry-over line
      second_half <- str_extract(chapter[r + 1], regex("^\\w+"))
      chapter[r + 1] <- gsub(
        str_extract(chapter[r + 1], regex("^\\w+")), "",
        chapter[r + 1]
      )
      chapter[r + 1] <- str_trim(chapter[r + 1], side = "left")

      # delete the end-hyphen, concatenate first- and second-half of hyphenated word
      chapter[r] <- gsub("\\-$", "", chapter[r])
      chapter[r] <- paste(chapter[r], second_half, sep = "")
    }
  }
  return(chapter)
}

apply()

n_chapters <- nrow(text)
for(i in 1:n_chapters){
  # single string of text that contains the entire chapter
  temp_chapter <- text[i,2]
  
  # rename string with appropriate chapter number
  assign(paste("chapter", i-1, "_raw", sep=""), temp_chapter)
}

chapter8 <- removeHyphen_concat(chapter8)
removeHyphen_concat(chapter8)
removeHyphen_concat(chapter8)
```

```{r}
# checking removeHyphen_concat() function with small test example
test <- c("The boy is in the hou-", 
          "se that is blue. He loves bulldogs and pine-", 
          "apples and bananas. Have a great day!")
test_fixed <- removeHyphen_concat(test)
test_fixed
```

