---
title: "Sentiment Analysis"
author: "Graham Chickering"
date: "9/30/2020"
output: pdf_document
---

```{r}
library(purrr)
```


```{r}
nrc<-tidytext::get_sentiments("nrc")

AC_sentiment_by_chapter <- tidy_DTM %>%
  inner_join(get_sentiments("nrc"), by = "word") %>% 
  count(index=chapterNum, sentiment) %>% 
  spread(sentiment, n, fill = 0)
AC_sentiment_by_chapter

```
```{r}
ggplot(data= AC_sentiment_by_chapter , aes(x=index, y= joy)) +
  geom_bar(alpha = 0.5, stat = "identity", show.legend = FALSE) + 
  labs(x="Chapter", y=paste( "Joy Count",sep=" "), 
       title=paste( "Joy Change Over the Course of the Book (nrc lexicon)", sep=" "))
```

```{r}
ggplot(data= AC_sentiment_by_chapter , aes(x=index, y= sadness)) +
  geom_bar(alpha = 0.5, stat = "identity", show.legend = FALSE) + 
  labs(x="Chapter", y=paste( "Sadness Count",sep=" "), 
       title=paste( "Sadness Change Over the Course of the Book (nrc lexicon)", sep=" "))
```



```{r}
get_emotion_plot<-function(.data, emotion){
 ggplot(data= .data, aes(x=index, y= emotion)) #+
#   geom_bar(alpha = 0.5, stat = "identity", show.legend = FALSE) +
#   labs(x="Chapter", y=paste(emotion, "Count",sep=" "),
#        title=paste(emotion, "Change Over the Course of the Book (nrc lexicon)", sep=" "))
}
```

```{r}
#trial<-c("anger")#, "anticipation", "disgust","fear","joy","negative","positive","sadness","suprise",   #"trust") 
#AC_sentiment_by_chapter %>% select(-index) %>%
#map(get_emotion_plot)
get_emotion_plot(AC_sentiment_by_chapter,"anger")
#AC_sentiment_by_chapter$"anger"
```


